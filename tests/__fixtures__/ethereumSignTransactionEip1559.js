// https://github.com/trezor/trezor-firmware/blob/1adc869626edf26158a22a4eeed997294c2394e4/tests/device_tests/test_msg_ethereum_signtx_eip1559.py

export default {
    method: 'ethereumSignTransaction',
    setup: {
        mnemonic: 'mnemonic_all',
    },
    tests: [
        {
            description: 'eip1559: no data',
            params: {
                path: "m/44'/60'/0'/0/100",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0x0a',
                    chainId: 1,
                },
            },
            result: {
                r: '0x2ceeaabc994fbce2fbd66551f9d48fc711c8db2a12e93779eeddede11e41f636',
                s: '0x2db4a9ecc73da91206f84397ae9287a399076fdc01ed7f3c6554b1c57c39bf8c',
                v: '0x1',
            },
        },
        {
            description: 'eip1559: data',
            params: {
                path: "m/44'/60'/0'/0/0",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0x0a',
                    chainId: 1,
                    data:
                        '0x6162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f706162636465666768696a6b6c6d6e6f70',
                },
            },
            result: {
                r: '0x8e4361e40e76a7cab17e0a982724bbeaf5079cd02d50c20d431ba7dde2404ea4',
                s: '0x411930f091bb508e593e22a9ee45bd4d9eeb504ac398123aec889d5951bdebc3',
                v: '0x0',
            },
        },
        {
            description: 'eip1559: data uppercase',
            params: {
                path: "m/44'/60'/0'/0/0",
                transaction: {
                    nonce: '0x01e240',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x4e20',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0xab54a98ceb1f0ad2',
                    chainId: 1,
                    data:
                        '0x4142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f504142434445464748494a4b4c4d4e4f50212121',
                },
            },
            result: {
                r: '0x2e4f4c0e7c4e51270b891480060712e9d3bcab01e8ad0fadf2dfddd71504ca94',
                s: '0x2599beb32757a144dedc82b79153c21269c9939a9245342bcf35764115b62bc1',
                v: '0x0',
            },
        },
        {
            description: 'eip1559: access list',
            params: {
                path: "m/44'/60'/0'/0/100",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0x0a',
                    chainId: 1,
                    accessList: [
                        {
                            address: '0xde0b295669a9fd93d5f28d9ec85e40f4cb697bae',
                            storageKeys: [
                                '0x0000000000000000000000000000000000000000000000000000000000000003',
                                '0x0000000000000000000000000000000000000000000000000000000000000007',
                            ],
                        },
                    ],
                },
            },
            result: {
                r: '0x9f8763f3ff8d4d409f6b96bc3f1d84dd504e2c667b162778508478645401f121',
                s: '0x51e30b68b9091cf8138c07380c4378c2711779b68b2e5264d141479f13a12f57',
                v: '0x1',
            },
        },
        {
            description: 'eip1559: access list larger',
            params: {
                path: "m/44'/60'/0'/0/100",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0x0a',
                    chainId: 1,
                    accessList: [
                        {
                            address: '0xde0b295669a9fd93d5f28d9ec85e40f4cb697bae',
                            storageKeys: [
                                '0x0000000000000000000000000000000000000000000000000000000000000003',
                                '0x0000000000000000000000000000000000000000000000000000000000000007',
                            ],
                        },
                        {
                            address: '0xbb9bc244d798123fde783fcc1c72d3bb8c189413',
                            storageKeys: [
                                '0x0000000000000000000000000000000000000000000000000000000000000006',
                                '0x0000000000000000000000000000000000000000000000000000000000000007',
                                '0x0000000000000000000000000000000000000000000000000000000000000009',
                            ],
                        },
                    ],
                },
            },
            result: {
                r: '0x718a3a30827c979975c846d2f60495310c4959ee3adce2d89e0211785725465c',
                s: '0x7d0ea2a28ef5702ca763c1f340427c0020292ffcbb4553dd1c8ea8e2b9126dbc',
                v: '0x1',
            },
        },
        {
            description: 'eip1559: known erc20 token',
            params: {
                path: "m/44'/60'/0'/0/0",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0xd0d6d6c5fe4a677d343cc433536bb717bae167dd', // ADT token address
                    value: '0x0',
                    chainId: 1,
                    data:
                        '0xa9059cbb000000000000000000000000574bbb36871ba6b78e27f4b4dcfb76ea0091880b000000000000000000000000000000000000000000000000000000000bebc200',
                },
            },
            result: {
                r: '0x94d67bacb7966f881339d91103f5d738d9c491fff4c01a6513c554ab15e86cc0',
                s: '0x405bd19a7bf4ae62d41fcb7844e36c786b106b456185c3d0877a7ce7eab6c751',
                v: '0x1',
            },
        },
        {
            description: 'eip1559: unknown erc20 token',
            params: {
                path: "m/44'/60'/0'/0/1",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0xfc6b5d6af8a13258f7cbd0d39e11b35e01a32f93', // unknown token address (Grzegorz Brzęczyszczykiewicz Token)
                    value: '0x0',
                    chainId: 1,
                    data:
                        '0xa9059cbb000000000000000000000000574bbb36871ba6b78e27f4b4dcfb76ea0091880b0000000000000000000000000000000000000000000000000000000000000123',
                },
            },
            result: {
                r: '0xe631b56bcc596844cb8686b2046e36cf33634aa396e7e1ea94a97aac02c18bda',
                s: '0x399bff8752539176c4b2f1d5d2a8f6029f79841d28802149ab339a033ffe4c1f',
                v: '0x1',
            },
        },
        {
            description: 'eip1559: large chain id',
            params: {
                path: "m/44'/60'/0'/0/100",
                transaction: {
                    nonce: '0x0',
                    maxFeePerGas: '0x14',
                    maxPriorityFeePerGas: '0x1',
                    gasLimit: '0x14',
                    to: '0x1d1c328764a41bda0492b66baa30c4a339ff85ef',
                    value: '0x0a',
                    chainId: 3125659152, // Pirl chain id, doesn't support EIP1559 at this time, but chosen for large chain id
                },
            },
            result: {
                r: '0x07f8c967227c5a190cb90525c3387691a426fe61f8e0503274280724060ea95c',
                s: '0x0bf83eaf74e24aa9146b23e06f9edec6e25acb81d3830e8d146b9e7b6923ad1e',
                v: '0x0',
            },
        },
    ],
};
